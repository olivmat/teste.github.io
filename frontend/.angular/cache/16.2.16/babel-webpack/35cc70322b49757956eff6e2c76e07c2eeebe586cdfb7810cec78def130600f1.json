{"ast":null,"code":"import Chart from 'chart.js/auto';\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\nimport { PersonModalComponent } from '../person-form/person-modal/person-modal.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/material/button\";\nimport * as i4 from \"@angular/material/icon\";\nexport class DashboardComponent {\n  constructor(http, dialog) {\n    this.http = http;\n    this.dialog = dialog;\n    this.totalCriancas = 0;\n    this.presentesUltimoDia = 0;\n    this.quantidade2a6 = 0;\n    this.quantidade7a11 = 0;\n    this.pessoas = [];\n    this.presencas = [];\n  }\n  ngOnInit() {\n    this.getTotalCriancas();\n    this.getPresentesUltimoDia();\n    this.getPessoasEPresencas();\n  }\n  ngAfterViewInit() {\n    setTimeout(() => this.renderizarGraficoPresencasPorDia(), 500);\n  }\n  getTotalCriancas() {\n    this.http.get('http://localhost:8000/people/').subscribe(data => {\n      this.totalCriancas = data.length;\n    });\n  }\n  getPresentesUltimoDia() {\n    this.http.get('http://localhost:8000/presences/').subscribe(data => {\n      if (data.length === 0) {\n        this.presentesUltimoDia = 0;\n        return;\n      }\n      // Encontrar a data mais recente\n      const datas = data.map(p => p.date);\n      const ultimaData = datas.sort().reverse()[0];\n      // Contar quantos presentes na última data\n      this.presentesUltimoDia = data.filter(p => p.date === ultimaData).length;\n    });\n  }\n  getPessoasEPresencas() {\n    this.http.get('http://localhost:8000/people/').subscribe(pessoas => {\n      this.pessoas = pessoas;\n      this.http.get('http://localhost:8000/presences/').subscribe(presencas => {\n        this.presencas = presencas;\n        this.calcularFaixasEtarias();\n        this.renderizarGraficoPresencasPorDia();\n      });\n    });\n  }\n  calcularFaixasEtarias() {\n    if (!this.presencas.length) {\n      this.quantidade2a6 = 0;\n      this.quantidade7a11 = 0;\n      return;\n    }\n    // Descobrir a data mais recente\n    const datas = this.presencas.map(p => p.date);\n    const ultimaData = datas.sort().reverse()[0];\n    // Filtrar presenças do último dia\n    const presencasUltimoDia = this.presencas.filter(p => p.date === ultimaData);\n    // Contar por faixa etária\n    let count2a6 = 0;\n    let count7a11 = 0;\n    presencasUltimoDia.forEach(presenca => {\n      const pessoa = this.pessoas.find(p => p.id === presenca.person_id);\n      if (pessoa && pessoa.idade !== undefined && pessoa.idade !== null) {\n        if (pessoa.idade >= 2 && pessoa.idade <= 6) count2a6++;\n        if (pessoa.idade >= 7 && pessoa.idade <= 11) count7a11++;\n      }\n    });\n    this.quantidade2a6 = count2a6;\n    this.quantidade7a11 = count7a11;\n  }\n  renderizarGraficoPresencasPorDia() {\n    if (!this.presencas || this.presencas.length === 0) return;\n    // Agrupar presenças por data\n    const presencasPorData = {};\n    this.presencas.forEach(p => {\n      if (!presencasPorData[p.date]) presencasPorData[p.date] = 0;\n      presencasPorData[p.date]++;\n    });\n    const rawLabels = Object.keys(presencasPorData).sort();\n    // Formatar datas para dd/mmm\n    const labels = rawLabels.map(dateStr => {\n      const d = new Date(dateStr);\n      return d.toLocaleDateString('pt-BR', {\n        day: '2-digit',\n        month: 'short'\n      }).replace('.', '');\n    });\n    const data = rawLabels.map(date => presencasPorData[date]);\n    const ctx = document.getElementById('presencasPorDiaChart')?.getContext('2d');\n    if (!ctx) return;\n    new Chart(ctx, {\n      type: 'bar',\n      data: {\n        labels,\n        datasets: [{\n          label: 'Presenças por dia',\n          data,\n          backgroundColor: 'rgba(30, 136, 229, 0.7)',\n          borderColor: 'rgba(30, 136, 229, 1)',\n          borderWidth: 1\n        }]\n      },\n      options: {\n        responsive: true,\n        maintainAspectRatio: false,\n        layout: {\n          padding: {\n            top: 30\n          }\n        },\n        plugins: {\n          legend: {\n            display: false\n          },\n          datalabels: {\n            anchor: 'end',\n            align: 'start',\n            color: '#222',\n            font: {\n              weight: 'bold',\n              size: 14\n            },\n            offset: 4,\n            formatter: function (value) {\n              return value;\n            }\n          }\n        },\n        scales: {\n          x: {\n            title: {\n              display: true,\n              text: 'Data'\n            },\n            grid: {\n              display: false\n            }\n          },\n          y: {\n            beginAtZero: true,\n            title: {\n              display: false\n            },\n            ticks: {\n              display: false\n            },\n            grid: {\n              display: false\n            },\n            border: {\n              display: false\n            }\n          }\n        }\n      },\n      plugins: [ChartDataLabels]\n    });\n  }\n  abrirModalCadastro() {\n    const dialogRef = this.dialog.open(PersonModalComponent, {\n      width: '600px'\n    });\n    dialogRef.afterClosed().subscribe(result => {\n      if (result) {\n        this.getTotalCriancas();\n        this.getPessoasEPresencas();\n      }\n    });\n  }\n  static {\n    this.ɵfac = function DashboardComponent_Factory(t) {\n      return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.MatDialog));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DashboardComponent,\n      selectors: [[\"app-dashboard\"]],\n      decls: 40,\n      vars: 4,\n      consts: [[1, \"dashboard-container\"], [2, \"width\", \"100%\", \"display\", \"flex\", \"justify-content\", \"center\", \"margin-bottom\", \"18px\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"dashboard-card\"], [1, \"card-title\"], [1, \"emoji\"], [1, \"card-value-subcard\"], [1, \"card-value\"], [2, \"width\", \"100%\", \"margin-top\", \"50px\"], [\"id\", \"presencasPorDiaChart\", 2, \"width\", \"80%\", \"max-width\", \"90%\", \"height\", \"300px\"]],\n      template: function DashboardComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function DashboardComponent_Template_button_click_2_listener() {\n            return ctx.abrirModalCadastro();\n          });\n          i0.ɵɵelementStart(3, \"mat-icon\");\n          i0.ɵɵtext(4, \"person_add\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(5, \" Nova Crian\\u00E7a \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"div\", 3)(7, \"div\", 4);\n          i0.ɵɵtext(8, \"Crian\\u00E7as Cadastradas\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"div\", 5);\n          i0.ɵɵtext(10, \"\\uD83D\\uDC76\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"div\", 6)(12, \"span\", 7);\n          i0.ɵɵtext(13);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(14, \"div\", 3)(15, \"div\", 4);\n          i0.ɵɵtext(16, \"Presentes no \\u00DAltimo Dia\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"div\", 5);\n          i0.ɵɵtext(18, \"\\u2705\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"div\", 6)(20, \"span\", 7);\n          i0.ɵɵtext(21);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(22, \"div\", 3)(23, \"div\", 4);\n          i0.ɵɵtext(24, \"Crian\\u00E7as 2 a 6 anos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"div\", 5);\n          i0.ɵɵtext(26, \"\\uD83E\\uDDD2\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(27, \"div\", 6)(28, \"span\", 7);\n          i0.ɵɵtext(29);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(30, \"div\", 3)(31, \"div\", 4);\n          i0.ɵɵtext(32, \"Crian\\u00E7as 7 a 11 anos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(33, \"div\", 5);\n          i0.ɵɵtext(34, \"\\uD83E\\uDDD1\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(35, \"div\", 6)(36, \"span\", 7);\n          i0.ɵɵtext(37);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(38, \"div\", 8);\n          i0.ɵɵelement(39, \"canvas\", 9);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(13);\n          i0.ɵɵtextInterpolate(ctx.totalCriancas);\n          i0.ɵɵadvance(8);\n          i0.ɵɵtextInterpolate(ctx.presentesUltimoDia);\n          i0.ɵɵadvance(8);\n          i0.ɵɵtextInterpolate(ctx.quantidade2a6);\n          i0.ɵɵadvance(8);\n          i0.ɵɵtextInterpolate(ctx.quantidade7a11);\n        }\n      },\n      dependencies: [i3.MatButton, i4.MatIcon],\n      styles: [\".dashboard-container[_ngcontent-%COMP%] {\\n  padding: 20px;\\n  max-width: 1200px;\\n  margin: 0 auto;\\n}\\n\\n.dashboard-grid[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\\n  gap: 20px;\\n  margin-top: 20px;\\n}\\n\\n.dashboard-card[_ngcontent-%COMP%] {\\n  background: white;\\n  border-radius: 8px;\\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\\n  padding: 20px;\\n  transition: transform 0.2s;\\n  height: 100%;\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.dashboard-card[_ngcontent-%COMP%]:hover {\\n  transform: translateY(-5px);\\n  box-shadow: 0 4px 8px rgba(0,0,0,0.15);\\n}\\n\\n.card-header[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  margin-bottom: 15px;\\n}\\n\\n.card-icon[_ngcontent-%COMP%] {\\n  width: 40px;\\n  height: 40px;\\n  margin-right: 15px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  background: #f0f7ff;\\n  border-radius: 8px;\\n}\\n\\n.card-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%] {\\n  color: #1976d2;\\n  font-size: 24px;\\n  width: 24px;\\n  height: 24px;\\n}\\n\\n.card-title[_ngcontent-%COMP%] {\\n  font-size: 1.2rem;\\n  font-weight: 500;\\n  color: #333;\\n  margin: 0;\\n}\\n\\n.card-content[_ngcontent-%COMP%] {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n  text-align: center;\\n}\\n\\n.card-value[_ngcontent-%COMP%] {\\n  font-size: 2.5rem;\\n  font-weight: 600;\\n  color: #1976d2;\\n  margin: 10px 0;\\n}\\n\\n.card-description[_ngcontent-%COMP%] {\\n  color: #666;\\n  font-size: 0.9rem;\\n  margin: 0;\\n}\\n\\n@media (max-width: 768px) {\\n  .dashboard-grid[_ngcontent-%COMP%] {\\n    grid-template-columns: 1fr;\\n  }\\n  \\n  .dashboard-card[_ngcontent-%COMP%] {\\n    margin-bottom: 15px;\\n  }\\n} \\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZGFzaGJvYXJkL2Rhc2hib2FyZC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBYTtFQUNiLGlCQUFpQjtFQUNqQixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtFQUNiLDJEQUEyRDtFQUMzRCxTQUFTO0VBQ1QsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLGtCQUFrQjtFQUNsQixxQ0FBcUM7RUFDckMsYUFBYTtFQUNiLDBCQUEwQjtFQUMxQixZQUFZO0VBQ1osYUFBYTtFQUNiLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLDJCQUEyQjtFQUMzQixzQ0FBc0M7QUFDeEM7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxZQUFZO0VBQ1osa0JBQWtCO0VBQ2xCLGFBQWE7RUFDYixtQkFBbUI7RUFDbkIsdUJBQXVCO0VBQ3ZCLG1CQUFtQjtFQUNuQixrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxjQUFjO0VBQ2QsZUFBZTtFQUNmLFdBQVc7RUFDWCxZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxpQkFBaUI7RUFDakIsZ0JBQWdCO0VBQ2hCLFdBQVc7RUFDWCxTQUFTO0FBQ1g7O0FBRUE7RUFDRSxPQUFPO0VBQ1AsYUFBYTtFQUNiLHNCQUFzQjtFQUN0Qix1QkFBdUI7RUFDdkIsbUJBQW1CO0VBQ25CLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsY0FBYztFQUNkLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsaUJBQWlCO0VBQ2pCLFNBQVM7QUFDWDs7QUFFQTtFQUNFO0lBQ0UsMEJBQTBCO0VBQzVCOztFQUVBO0lBQ0UsbUJBQW1CO0VBQ3JCO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIuZGFzaGJvYXJkLWNvbnRhaW5lciB7XHJcbiAgcGFkZGluZzogMjBweDtcclxuICBtYXgtd2lkdGg6IDEyMDBweDtcclxuICBtYXJnaW46IDAgYXV0bztcclxufVxyXG5cclxuLmRhc2hib2FyZC1ncmlkIHtcclxuICBkaXNwbGF5OiBncmlkO1xyXG4gIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KGF1dG8tZml0LCBtaW5tYXgoMzAwcHgsIDFmcikpO1xyXG4gIGdhcDogMjBweDtcclxuICBtYXJnaW4tdG9wOiAyMHB4O1xyXG59XHJcblxyXG4uZGFzaGJvYXJkLWNhcmQge1xyXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gIGJvcmRlci1yYWRpdXM6IDhweDtcclxuICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLDAsMCwwLjEpO1xyXG4gIHBhZGRpbmc6IDIwcHg7XHJcbiAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnM7XHJcbiAgaGVpZ2h0OiAxMDAlO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxufVxyXG5cclxuLmRhc2hib2FyZC1jYXJkOmhvdmVyIHtcclxuICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTVweCk7XHJcbiAgYm94LXNoYWRvdzogMCA0cHggOHB4IHJnYmEoMCwwLDAsMC4xNSk7XHJcbn1cclxuXHJcbi5jYXJkLWhlYWRlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIG1hcmdpbi1ib3R0b206IDE1cHg7XHJcbn1cclxuXHJcbi5jYXJkLWljb24ge1xyXG4gIHdpZHRoOiA0MHB4O1xyXG4gIGhlaWdodDogNDBweDtcclxuICBtYXJnaW4tcmlnaHQ6IDE1cHg7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gIGJhY2tncm91bmQ6ICNmMGY3ZmY7XHJcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG59XHJcblxyXG4uY2FyZC1pY29uIG1hdC1pY29uIHtcclxuICBjb2xvcjogIzE5NzZkMjtcclxuICBmb250LXNpemU6IDI0cHg7XHJcbiAgd2lkdGg6IDI0cHg7XHJcbiAgaGVpZ2h0OiAyNHB4O1xyXG59XHJcblxyXG4uY2FyZC10aXRsZSB7XHJcbiAgZm9udC1zaXplOiAxLjJyZW07XHJcbiAgZm9udC13ZWlnaHQ6IDUwMDtcclxuICBjb2xvcjogIzMzMztcclxuICBtYXJnaW46IDA7XHJcbn1cclxuXHJcbi5jYXJkLWNvbnRlbnQge1xyXG4gIGZsZXg6IDE7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xyXG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4uY2FyZC12YWx1ZSB7XHJcbiAgZm9udC1zaXplOiAyLjVyZW07XHJcbiAgZm9udC13ZWlnaHQ6IDYwMDtcclxuICBjb2xvcjogIzE5NzZkMjtcclxuICBtYXJnaW46IDEwcHggMDtcclxufVxyXG5cclxuLmNhcmQtZGVzY3JpcHRpb24ge1xyXG4gIGNvbG9yOiAjNjY2O1xyXG4gIGZvbnQtc2l6ZTogMC45cmVtO1xyXG4gIG1hcmdpbjogMDtcclxufVxyXG5cclxuQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7XHJcbiAgLmRhc2hib2FyZC1ncmlkIHtcclxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyO1xyXG4gIH1cclxuICBcclxuICAuZGFzaGJvYXJkLWNhcmQge1xyXG4gICAgbWFyZ2luLWJvdHRvbTogMTVweDtcclxuICB9XHJcbn0gIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["Chart","ChartDataLabels","PersonModalComponent","DashboardComponent","constructor","http","dialog","totalCriancas","presentesUltimoDia","quantidade2a6","quantidade7a11","pessoas","presencas","ngOnInit","getTotalCriancas","getPresentesUltimoDia","getPessoasEPresencas","ngAfterViewInit","setTimeout","renderizarGraficoPresencasPorDia","get","subscribe","data","length","datas","map","p","date","ultimaData","sort","reverse","filter","calcularFaixasEtarias","presencasUltimoDia","count2a6","count7a11","forEach","presenca","pessoa","find","id","person_id","idade","undefined","presencasPorData","rawLabels","Object","keys","labels","dateStr","d","Date","toLocaleDateString","day","month","replace","ctx","document","getElementById","getContext","type","datasets","label","backgroundColor","borderColor","borderWidth","options","responsive","maintainAspectRatio","layout","padding","top","plugins","legend","display","datalabels","anchor","align","color","font","weight","size","offset","formatter","value","scales","x","title","text","grid","y","beginAtZero","ticks","border","abrirModalCadastro","dialogRef","open","width","afterClosed","result","i0","ɵɵdirectiveInject","i1","HttpClient","i2","MatDialog","selectors","decls","vars","consts","template","DashboardComponent_Template","rf","ɵɵelementStart","ɵɵlistener","DashboardComponent_Template_button_click_2_listener","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate"],"sources":["C:\\Users\\mathe\\Documents\\Kids\\Cadastro Local Kids\\frontend\\src\\app\\dashboard\\dashboard.component.ts","C:\\Users\\mathe\\Documents\\Kids\\Cadastro Local Kids\\frontend\\src\\app\\dashboard\\dashboard.component.html"],"sourcesContent":["import { Component, OnInit, AfterViewInit } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport Chart from 'chart.js/auto';\r\nimport ChartDataLabels from 'chartjs-plugin-datalabels';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { PersonModalComponent } from '../person-form/person-modal/person-modal.component';\r\n\r\n@Component({\r\n  selector: 'app-dashboard',\r\n  templateUrl: './dashboard.component.html',\r\n  styleUrls: ['./dashboard.component.css']\r\n})\r\nexport class DashboardComponent implements OnInit, AfterViewInit {\r\n  totalCriancas: number = 0;\r\n  presentesUltimoDia: number = 0;\r\n  quantidade2a6: number = 0;\r\n  quantidade7a11: number = 0;\r\n  pessoas: any[] = [];\r\n  presencas: any[] = [];\r\n\r\n  constructor(private http: HttpClient, private dialog: MatDialog) {}\r\n\r\n  ngOnInit(): void {\r\n    this.getTotalCriancas();\r\n    this.getPresentesUltimoDia();\r\n    this.getPessoasEPresencas();\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    setTimeout(() => this.renderizarGraficoPresencasPorDia(), 500);\r\n  }\r\n\r\n  getTotalCriancas() {\r\n    this.http.get<any[]>('http://localhost:8000/people/').subscribe(data => {\r\n      this.totalCriancas = data.length;\r\n    });\r\n  }\r\n\r\n  getPresentesUltimoDia() {\r\n    this.http.get<any[]>('http://localhost:8000/presences/').subscribe(data => {\r\n      if (data.length === 0) {\r\n        this.presentesUltimoDia = 0;\r\n        return;\r\n      }\r\n      // Encontrar a data mais recente\r\n      const datas = data.map(p => p.date);\r\n      const ultimaData = datas.sort().reverse()[0];\r\n      // Contar quantos presentes na última data\r\n      this.presentesUltimoDia = data.filter(p => p.date === ultimaData).length;\r\n    });\r\n  }\r\n\r\n  getPessoasEPresencas() {\r\n    this.http.get<any[]>('http://localhost:8000/people/').subscribe(pessoas => {\r\n      this.pessoas = pessoas;\r\n      this.http.get<any[]>('http://localhost:8000/presences/').subscribe(presencas => {\r\n        this.presencas = presencas;\r\n        this.calcularFaixasEtarias();\r\n        this.renderizarGraficoPresencasPorDia();\r\n      });\r\n    });\r\n  }\r\n\r\n  calcularFaixasEtarias() {\r\n    if (!this.presencas.length) {\r\n      this.quantidade2a6 = 0;\r\n      this.quantidade7a11 = 0;\r\n      return;\r\n    }\r\n    // Descobrir a data mais recente\r\n    const datas = this.presencas.map(p => p.date);\r\n    const ultimaData = datas.sort().reverse()[0];\r\n    // Filtrar presenças do último dia\r\n    const presencasUltimoDia = this.presencas.filter(p => p.date === ultimaData);\r\n    // Contar por faixa etária\r\n    let count2a6 = 0;\r\n    let count7a11 = 0;\r\n    presencasUltimoDia.forEach(presenca => {\r\n      const pessoa = this.pessoas.find(p => p.id === presenca.person_id);\r\n      if (pessoa && pessoa.idade !== undefined && pessoa.idade !== null) {\r\n        if (pessoa.idade >= 2 && pessoa.idade <= 6) count2a6++;\r\n        if (pessoa.idade >= 7 && pessoa.idade <= 11) count7a11++;\r\n      }\r\n    });\r\n    this.quantidade2a6 = count2a6;\r\n    this.quantidade7a11 = count7a11;\r\n  }\r\n\r\n  renderizarGraficoPresencasPorDia() {\r\n    if (!this.presencas || this.presencas.length === 0) return;\r\n    // Agrupar presenças por data\r\n    const presencasPorData: { [data: string]: number } = {};\r\n    this.presencas.forEach(p => {\r\n      if (!presencasPorData[p.date]) presencasPorData[p.date] = 0;\r\n      presencasPorData[p.date]++;\r\n    });\r\n    const rawLabels = Object.keys(presencasPorData).sort();\r\n    // Formatar datas para dd/mmm\r\n    const labels = rawLabels.map(dateStr => {\r\n      const d = new Date(dateStr);\r\n      return d.toLocaleDateString('pt-BR', { day: '2-digit', month: 'short' }).replace('.', '');\r\n    });\r\n    const data = rawLabels.map(date => presencasPorData[date]);\r\n    const ctx = (document.getElementById('presencasPorDiaChart') as HTMLCanvasElement)?.getContext('2d');\r\n    if (!ctx) return;\r\n    new Chart(ctx, {\r\n      type: 'bar',\r\n      data: {\r\n        labels,\r\n        datasets: [{\r\n          label: 'Presenças por dia',\r\n          data,\r\n          backgroundColor: 'rgba(30, 136, 229, 0.7)',\r\n          borderColor: 'rgba(30, 136, 229, 1)',\r\n          borderWidth: 1\r\n        }]\r\n      },\r\n      options: {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        layout: {\r\n          padding: {\r\n            top: 30\r\n          }\r\n        },\r\n        plugins: {\r\n          legend: { display: false },\r\n          datalabels: {\r\n            anchor: 'end',\r\n            align: 'start',\r\n            color: '#222',\r\n            font: { weight: 'bold', size: 14 },\r\n            offset: 4,\r\n            formatter: function(value: any) { return value; }\r\n          }\r\n        },\r\n        scales: {\r\n          x: {\r\n            title: { display: true, text: 'Data' },\r\n            grid: { display: false }\r\n          },\r\n          y: {\r\n            beginAtZero: true,\r\n            title: { display: false },\r\n            ticks: { display: false },\r\n            grid: { display: false },\r\n            border: { display: false }\r\n          }\r\n        }\r\n      },\r\n      plugins: [ChartDataLabels]\r\n    });\r\n  }\r\n\r\n  abrirModalCadastro() {\r\n    const dialogRef = this.dialog.open(PersonModalComponent, {\r\n      width: '600px'\r\n    });\r\n    dialogRef.afterClosed().subscribe(result => {\r\n      if (result) {\r\n        this.getTotalCriancas();\r\n        this.getPessoasEPresencas();\r\n      }\r\n    });\r\n  }\r\n} ","<div class=\"dashboard-container\">\r\n  <div style=\"width: 100%; display: flex; justify-content: center; margin-bottom: 18px;\">\r\n    <button mat-raised-button color=\"primary\" (click)=\"abrirModalCadastro()\">\r\n      <mat-icon>person_add</mat-icon>\r\n      Nova Criança\r\n    </button>\r\n  </div>\r\n  <div class=\"dashboard-card\">\r\n    <div class=\"card-title\">Crianças Cadastradas</div>\r\n    <div class=\"emoji\">👶</div>\r\n    <div class=\"card-value-subcard\">\r\n      <span class=\"card-value\">{{ totalCriancas }}</span>\r\n    </div>\r\n  </div>\r\n  <div class=\"dashboard-card\">\r\n    <div class=\"card-title\">Presentes no Último Dia</div>\r\n    <div class=\"emoji\">✅</div>\r\n    <div class=\"card-value-subcard\">\r\n      <span class=\"card-value\">{{ presentesUltimoDia }}</span>\r\n    </div>\r\n  </div>\r\n  <div class=\"dashboard-card\">\r\n    <div class=\"card-title\">Crianças 2 a 6 anos</div>\r\n    <div class=\"emoji\">🧒</div>\r\n    <div class=\"card-value-subcard\">\r\n      <span class=\"card-value\">{{ quantidade2a6 }}</span>\r\n    </div>\r\n  </div>\r\n  <div class=\"dashboard-card\">\r\n    <div class=\"card-title\">Crianças 7 a 11 anos</div>\r\n    <div class=\"emoji\">🧑</div>\r\n    <div class=\"card-value-subcard\">\r\n      <span class=\"card-value\">{{ quantidade7a11 }}</span>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div style=\"width: 100%; margin-top: 50px;\">\r\n  <canvas id=\"presencasPorDiaChart\" style=\"width: 80%; max-width: 90%; height: 300px;\"></canvas>\r\n</div>\r\n\r\n<script>\r\n  document.addEventListener('DOMContentLoaded', function() {\r\n    const ctx = document.getElementById('presencasPorDiaChart').getContext('2d');\r\n    const chart = new Chart(ctx, {\r\n      type: 'line',\r\n      data: {\r\n        labels: ['Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado', 'Domingo'],\r\n        datasets: [{\r\n          label: 'Presenças',\r\n          data: [12, 19, 3, 5, 2, 3, 10],\r\n          borderColor: 'rgb(255, 99, 132)',\r\n          backgroundColor: 'rgba(255, 99, 132, 0.5)',\r\n          y: {\r\n            beginAtZero: true,\r\n            title: { display: false },\r\n            ticks: { display: false },\r\n            grid: { display: false },\r\n            border: { display: false }\r\n          }\r\n        }]\r\n      },\r\n      options: {\r\n        scales: {\r\n          y: {\r\n            beginAtZero: true,\r\n            title: { display: false },\r\n            ticks: { display: false },\r\n            grid: { display: false },\r\n            border: { display: false }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  });\r\n</script> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}